<!DOCTYPE html>
<html>
<head>
    <title>Commissions Paid - Finance Admin</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
    <style>
      @media (max-width:600px){.table,.btn{font-size:.98em;}}
      .btn-nav{min-width:165px;}
      .summary-card{background:#f7fafb;border-radius:13px;box-shadow:0 1px 6px #e1e9ed;padding:18px 12px 9px 12px;margin:16px 0 28px 0;}
    </style>
</head>
<body>
<div class="container py-4">
  <div class="d-flex justify-content-between align-items-center mb-2 flex-wrap">
    <h3 class="mb-2">Commissions Paid</h3>
    <a href="{{ url_for('finance_dashboard') }}" class="btn btn-outline-primary mb-2">Return to Finance Dashboard</a>
  </div>
  <div class="d-flex justify-content-end mb-3">
    <a href="{{ url_for('export_commissions_paid_csv', period=period, year=year or '', month=month or '') }}" class="btn btn-outline-success me-2">
        <i class="bi bi-cloud-arrow-down"></i> Export CSV/Excel
    </a>
  </div>
  <form class="row gy-2 gx-2 mb-3" id="filter-form" method="get">
    <div class="col-12 col-sm-3">
      <select class="form-select" name="period" onchange="this.form.submit()">
        <option value="all" {% if not period or period == 'all' %}selected{% endif %}>All Time</option>
        <option value="year" {% if period == 'year' %}selected{% endif %}>Full Year</option>
        <option value="month" {% if period == 'month' %}selected{% endif %}>Month</option>
      </select>
    </div>
    <div class="col-12 col-sm-3">
      <input type="number" name="year" id="year" class="form-control" placeholder="Year (YYYY)" value="{{ year or '' }}">
    </div>
    <div class="col-12 col-sm-3">
      <input type="number" min="1" max="12" name="month" id="month" class="form-control" placeholder="Month (1-12)" value="{{ month or '' }}">
    </div>
  </form>
  <div class="table-responsive">
    <table class="table table-bordered align-middle" id="commissions-table">
      <thead class="table-light">
        <tr>
          <th>User Referral ID</th>
          <th>Name</th>
          <th>Email</th>
          <th>Tier 2 (0.25%)</th>
          <th>Tier 3 (0.25%)</th>
          <th>Tier 4 (0.25%)</th>
          <th>Tier 5 (2%)</th>
          <th>Grand Total</th>
        </tr>
      </thead>
      <tbody>
        {% for u in users %}
        <tr>
          <td>{{ u.referral_id }}</td>
          <td>{{ u.name }}</td>
          <td>{{ u.email }}</td>
          <td>${{ "{:,.2f}".format(u.tier2) }}</td>
          <td>${{ "{:,.2f}".format(u.tier3) }}</td>
          <td>${{ "{:,.2f}".format(u.tier4) }}</td>
          <td>${{ "{:,.2f}".format(u.tier5) }}</td>
          <td>${{ "{:,.2f}".format(u.grand_total) }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
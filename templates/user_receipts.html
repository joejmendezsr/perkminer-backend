<!DOCTYPE html>
<html>
<head>
    <title>My Receipts - PerkMiner</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
</head>
<body>
<div class="container py-4">
  <h3 class="mb-3 text-center">My Receipts</h3>
  {% if transactions %}
    <div class="table-responsive">
      <table class="table table-bordered">
        <thead class="table-light">
          <tr>
            <th>Date/Time</th>
            <th>Business</th>
            <th>Amount</th>
            <th>Cashback (2%)</th>
            <th>Receipt</th>
          </tr>
        </thead>
        <tbody>
          {% for txn in transactions %}
          <tr>
            <td>{{ txn.date_time.strftime('%Y-%m-%d %I:%M %p') }}</td>
            <td>
              {% set interaction = txn.interaction %}
              {{ interaction.business.business_name if interaction else 'N/A' }}
            </td>
            <td>${{ "{:,.2f}".format(txn.amount) }}</td>
            <td>${{ "{:,.2f}".format(txn.cash_back) }}</td>
            <td>
              <a href="{{ url_for('show_user_receipt', interaction_id=txn.interaction_id) }}" class="btn btn-info btn-sm">View</a>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  {% else %}
    <div class="alert alert-info text-center">No receipts yet.</div>
  {% endif %}
  <a href="{{ url_for('dashboard') }}" class="btn btn-primary mt-3 w-100">Back to Dashboard</a>
</div>
</body>
</html>
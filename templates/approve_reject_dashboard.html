<!DOCTYPE html>
<html>
<head>
    <title>Approve/Reject Listings - Admin</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
</head>
<body>
<div class="container py-5" style="max-width:900px;">
    <h2 class="mb-4 text-center">Approve/Reject Listings</h2>
    <div class="alert alert-info text-center">
        Here you will manage and review submissions.
    </div>
    {% if pending_listings %}
      <div class="table-responsive">
        <table class="table table-bordered align-middle">
          <thead class="table-light">
            <tr>
              <th>ID</th>
              <th>Business Name</th>
              <th>Category</th>
              <th>Email</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            {% for biz in pending_listings %}
              <tr {% if biz.status == "in_review" %}class="table-warning"{% endif %}>
                <td>{{ biz.id }}</td>
                <td>{{ biz.business_name }}</td>
                <td>{{ biz.category }}</td>
                <td>{{ biz.business_email }}</td>
                <td>
                  {% if biz.status == "pending" %}
                    <span class="badge rounded-pill bg-secondary">Pending Review</span>
                  {% elif biz.status == "in_review" %}
                    <span class="badge rounded-pill bg-warning text-dark">In Review</span>
                  {% endif %}
                </td>
                <td class="d-flex gap-1">
                  <!-- Start Review -->
                  <form method="post" action="{{ url_for('start_review', listing_id=biz.id) }}">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                    <button type="submit" class="btn btn-primary btn-sm"
                      {% if biz.status != "pending" %}disabled{% endif %}>
                      Start Review
                    </button>
                  </form>
                  <!-- Approve -->
                  <form method="post" action="{{ url_for('approve_listing', listing_id=biz.id) }}">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                    <button type="submit" class="btn btn-success btn-sm"
                      {% if biz.status != "in_review" %}disabled{% endif %}>
                      Approve
                    </button>
                  </form>
                  <!-- Reject -->
                  <form method="post" action="{{ url_for('reject_listing', listing_id=biz.id) }}">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                    <button type="submit" class="btn btn-danger btn-sm"
                      {% if biz.status != "in_review" %}disabled{% endif %}>
                      Reject
                    </button>
                  </form>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <div class="alert alert-success text-center mt-4">
        No pending listings at this time.
      </div>
    {% endif %}
    <div class="text-center mt-4">
        <a href="{{ url_for('admin_roles_landing') }}" class="btn btn-secondary">Back to Admin Area</a>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>